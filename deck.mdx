import { syntaxHighlighter } from 'mdx-deck/themes'
import adapt from './theme/adapt'
import AdaptLayout from './theme/adaptLayout'
import { Notes, Image, Horizontal, Appear } from 'mdx-deck'
import css3 from './assets/images/css3-logo.svg'
import html5 from './assets/images/html5-logo.svg'
import js from './assets/images/js-logo.svg'

export const themes = [syntaxHighlighter, adapt]

<AdaptLayout>

  # Drupal 8 & Gatsby JS
  ## What, Why & How

</AdaptLayout>

---

<AdaptLayout>

  # Zach Weishar
  ## Senior Technical Solutions Manager
  ### @[Adapt](https://adaptagency.com/)

<Notes>
  <ul>
    <li>Full service digital agency with offices in Boston, Copenhagen, Berlin, Barcelona, Kaunas and Vilnius</li>
    <li>We work with diverse array of technologies, including React and Drupal.</li>
    <li>Gatsby is a fascinating intersection between Drupal + React</li>
  </ul>
</Notes>

</AdaptLayout>

---

<AdaptLayout>

# JAMstack
## Javascript, APIs, Markup

<Horizontal style="align-items: flex-start;">
  <img src={html5} style="width: 100%; max-width: 350px;" />
  <img src={js} style="width: 100%; max-width: 350px;" />
  <img src={css3} style="width: 100%; max-width: 350px;" />
</Horizontal>

<Notes>
  <ul>
    <li>JAMstacks are analogous to static sites. The key concept is that they do not nessicarily rely on a server to render HTML documents. Instead, HTML documents are generated, or created ahead of time.</li>
    <li>Gatsby handles this as part of a build process, where it generates all the pages on your site. However, the concept would be the same if you wanted to write HTML by hand.</li>
    <li>In a sense, this is a return to basics. HTML, CSS + JS are the foundation of the web platform. CMSs like Drupal provide a useful abstraction on top of this foundation.</li>
  </ul>
</Notes>

</AdaptLayout>

---

<AdaptLayout>

  # Why JAMstack?

  <ul>
    <li>Fast page loads</li>
    <Appear>
      <li>Better security</li>
      <li>Lower hosting costs</li>
      <li>Decoupled from your back-end</li>
    </Appear>
  </ul>

  <Notes>
    <ul>
      <li>HTML documents are generated ahead of time, which means that your users don't need to wait for a server to generate pages on demand. Smart engineers have developed caches like Varnish to mitigate this problem for server rendered sites, but this is an added layer of compleixty for your stack.</li>
      <li>In addition, the fact that JAMstack's are a collection of static HTML documents means that you can easily distribute them to your Content Delivery Network (CDN) of choice. This means that users get served from a data center that is geographically close to them, further improving the speed of the site.</li>
      <li>Outside of the build process, JAMstack's do not need a direct connection to a server in order to operate. This means no more monitoring for Drupal secuirty updates, no more worrying about patching your servers. Let a company like Amazon or Netlify worry about that so you don't have to.</li>
      <li>Professional hosting for a Drupal site is complicated and expensive. With a JAMstack, you don't have to pay these prices. Instead, you can host inexpensively with a static hosting provider like Amazon's S3, Netlify or Zeit.</li>
      <li>This may or may not be a positive depending on the project requirements, but it certaintly offers you a lot of flexiblity. This allows you to mix and match data sources or swap out your back-end down the line with minimal refactoring to your codebase. Of course, your data manimpulation will need to change if you change out your back-end, but your HTML, CSS + JS can largely remain the same.</li>
  </ul>
  </Notes>

</AdaptLayout>

---

<AdaptLayout>

  # Why Gatsby?

  <ul>
    <li>Even faster page loads</li>
    <Appear>
      <li>Next level image handling</li>
      <li>Data agnostic</li>
      <li>Progressive Web App (PWA) support out of the box</li>
      <li>Rich ecosystem of plugins</li>
    </Appear>
  </ul>

<Notes>
  <ul>
    <li>Performance best practices are baked into Gatsby, which means you get even better perofrmance than with a traditional static site generator. You get things like inlining of critical CSS, prefetching of linked pages, and page caching out of the box.</li>
    <li>Gatsby is built on React, so you get to use all the shiny new front-end tech you see on Twitter.</li>
    <li>Gatsby provides native support for responsive images and for progressive image loading (aka the blur technique from Medium)</li>
    <li>It's simple to add PWA support to your site out of the box, which means that your users can use the site offline. Complex PWA use cases will still require custom code, but Gatsby offers a great baseline here to get you started.</li>
    <li>Much like the Drupal community, the Gatsby community is excellent. There are plugins for just about every data source and use case that you can possibly think of. Honestly, I was shocked to see how far along the ecosysem has come in a relatively short amount of time.</li>
  </ul>
</Notes>

</AdaptLayout>

---

<AdaptLayout>

  # Why Drupal?

  <Appear>
    <iframe src="https://giphy.com/embed/kr5PszPQawIRq" width="328" height="480" frameBorder="0" class="giphy-embed" allowFullScreen />
  </Appear>


  <Notes>
    You're at a Drupal conference, you don't need me to evangelize Drupal for you.
  </Notes>

</AdaptLayout>

---

<AdaptLayout>

  # Drupal + Gatsby

  <ul>
    <li>Drupal is excellent at modeling content and creating structured data</li>
    <Appear>
      <li>Gatsby is an excellent platform for building user intfaces (UI's)</li>
      <li>Gatsby's developer experiance is first class, especially for teams that have already embraced React</li>
      <li>Much of the integration between Gatsby + Drupal is solved by pre-existing plugins</li>
    </Appear>
  </ul>

  <Notes>
    <ul>
      <li>This combination plays to the strengths of both Drupal + Gatsby</li>
      <li>This on top of the benefits that come with the JAM stack itself</li>
    </ul>
  </Notes>

</AdaptLayout>

---

<AdaptLayout>

  # What you loose

</AdaptLayout>

---

<AdaptLayout>

  # Views

  <ul>
    <li>Querying data is done via JSON API Module</li>
    <li>JSON API currently only supports single bundle collections</li>
    <li>No built in view filters, pagination, etc.</li>
  </ul>

</AdaptLayout>

---

<AdaptLayout>

  # Web Forms + Comments

  <ul>
    <li>There is no server to handle form submissions</li>
    <li>You need to adpot a client-side solution instead</li>
  </ul>

  <Notes>
    <ul>
      <li>You set up an API route for form submissions on your Drupal site, but if you put Drupal back into the critical path of your application, you negate many of the benefits of this approach</li>
    </ul>
  </Notes>

</AdaptLayout>

---

<AdaptLayout>

  # Automatic redirect creation

  <ul>
    <li>The redirect module is a no brainer on a standard Drupal site, but it won't help you in a decoupled site</li>
    <li>This may be a deal breaker for fickle content editors and SEO buffs</li>
  </ul>

</AdaptLayout>

---

<AdaptLayout>

  # Built in Authentication

  <ul>
    <li>Once again, you need to roll your own client-side solution</li>
  </ul>

</AdaptLayout>

---

<AdaptLayout>

  # Content Preview

  <ul>
    <li>Gatsby needs to build in order to see changes on the live site</li>
    <li>If you don't want to preview in production, you also need to add a staging environment for preview</li>
    <li>The Gatsby team has rolled out their first SaaS product to solve this, Gatsby Preview</li>
  </ul>

</AdaptLayout>

<Notes>
  <ul>
    <li>Waiting for the site to re-build to preview will become an unnaceptable solution. As the site grows, build times increase</li>
    <li>Almost no one will be ok with previewing in production</li>
    <li>Gatsby preview works really well from what I saw, and there is a companion Drupal module developed by Third & Grove</li>
  </ul>
</Notes>

---

<AdaptLayout>

  # Client-side solutions

  <ul>
    <li>Search
      <ul>
        <li>Pure client-side search, such as JS Search</li>
        <li>API based search such as Aloglia (SaaS), Solr, or Elastic Search</li>
      </ul>
    </li>
    <li>Comments
      <ul>
        <li>Disqus, or a similar client-side solution</li>
      </ul>
    </li>
    <li>Webforms
      <ul>
        <li>TypeForm, Wufoo or another client-side SaaS offering</li>
      </ul>
    </li>
  </ul>

  <Notes>
    <ul>
      <li>Client-side search might be acceptable for very small indexes, but the index gets downloaded on page load, so as it grows your site will slow down</li>
      <li>API based search is much more robust, but of course adds compleixty (or cost if SaaS) to your stack</li>
    </ul>
  </Notes>

</AdaptLayout>

---

<AdaptLayout>

  # Redirects

  <ul>
    <li>Create redirects in Drupal as usual. At build time, register redirects with your host</li>
    <li>S3: API for CUD updates on redirects</li>
    <li>Netlify: Configure redirects in _redirects file or netlify.toml</li>
  </ul>

</AdaptLayout>

<Notes>
  <ul>
    <li>I haven't built an integration like this before, so it's theoretical at this point. But it should be possible</li>
  </ul>
</Notes>

---

<AdaptLayout>

  # Cutting the cord

  <ul>
    <li>Have you ditched cable for streaming services? This is a similar decision</li>
    <li>Choose exactly what you want and cut what you don't</li>
    <li>But if you want a full cable replacement, the cost of each peice in aggregate might be more than cable</li>
  </ul>

</AdaptLayout>

<Notes>
  <ul>
    <li>I'm not just talking about the cost of the SaaS replacements, though that is definetely something to keep an eye on</li>
    <li>I'm also talking about the complexity you introduce to your system by cobbling together all of these services. Some of these problems are relatively easy to solve, others aren't (search)</li>
  </ul>
</Notes>

---

<AdaptLayout>

  # Gatsby + D8 might make sense when...

  <ul>
    <li>Client doesn't have a large budget for hosting</li>
    <Appear>
      <li>Client doesn't have a dev team to perform security updates</li>
      <li>Performance is a top priority</li>
      <li>You need to pull content from multiple sources</li>
      <li>You have a team of Front-end devs that like working in React</li>
      <li>You're building an interactive app with some static content mixed in</li>
    </Appear>

  </ul>

  <Notes>
    <ul>
      <li>You have to wait for a build to change content, and builds take minutes to finish. If content is updated more quickly than your build process, things will get ugly</li>
      <li>You could mitigate the issue of frequent content updates by scheduling builds. For instance, everything that's published gets deployed automatically at Noon and 5pm</li>
      <li>The more pages you're building, the longer the build process will take</li>
      <li>The client is not waiting for page generation, and your site can be served entierly from a CDN</li>
      <li>Reduce context switching and increasing the ability to reuse components accross projects</li>
      <li>Gatsby is a platform for building React applications</li>
    </ul>
  </Notes>

</AdaptLayout>

---

<AdaptLayout>

  # Gatsby + D8 might not make sense when...

  <ul>
    <li>Site has an extremely high node count</li>
    <Appear>
      <li>Site content is updated frequently</li>
      <li>Site serves personalized pages for authenticated users</li>
    </Appear>
  </ul>

</AdaptLayout>

---

<AdaptLayout>

  # It's a balancing act

  ## You have to decide if the benefits outweigh the challanges for your project

</AdaptLayout>

---

<AdaptLayout>

  # Looking to the future

  <ul>
    <li>Gatsby / Drupal integration will continue to improve + develop along with Drupal's API first initiative</li>
    <li>Gatsby itself is a venture backed company, which means it's likely to continue innovating</li>
    <li>Gatsby is extremely popular right now, but that may fade over time. The concept of the JAM Stack is more durable and more important</li>
  </ul>

</AdaptLayout>

<Notes>
  <ul>
    <li>Until recently, cross bundle collections were not supported by JSON API. The jsonapi_cross_bundles module aims to solve that</li>
    <li>Gatsby's first product is Preview, but I assume they will continue to roll out more over time</li>
    <li>I don't know what the future holds for Gatsby, but I can say with a fair bit of confidence that JAM Stack will continue to grow in popularity and utility long into the future</li>
  </ul>
</Notes>

---

<AdaptLayout>

# Technical Resources

<ul>
  <li>Rain drupal distribution: https://www.drupal.org/project/rain</li>
  <li>Rain Gatsby companion: https://bitbucket.org/mediacurrent/mis_gatsby_rain/src/develop/</li>
  <li>Build hooks module: https://www.drupal.org/project/build_hooks</li>
  <li>Gatsby live preview: https://www.drupal.org/project/gatsby</li>
  <li>JSON:API Cross Bundles: https://www.drupal.org/project/jsonapi_cross_bundles/</li>
</ul>

</AdaptLayout>

---

<AdaptLayout>

# Educational Resources

<ul>
  <li>Infustructure examples: https://www.mediacurrent.com/blog/drupal-behind-firewall-gatsby</li>
</ul>

</AdaptLayout>

---

<AdaptLayout>

# The end

</AdaptLayout>
