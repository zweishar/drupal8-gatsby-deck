import { syntaxHighlighter } from 'mdx-deck/themes'
import adapt from './theme/adapt'
import AdaptLayout from './theme/adaptLayout'
import { Notes, Image, Horizontal, Appear } from 'mdx-deck'
import css3 from './assets/images/css3-logo.svg'
import html5 from './assets/images/html5-logo.svg'
import js from './assets/images/js-logo.svg'

export const themes = [syntaxHighlighter, adapt]

<AdaptLayout>

  # Drupal 8 & Gatsby JS
  ## What, Why & How

</AdaptLayout>

<Notes>
  <ul>
    <li>This isn't a technical deep dive, or a hands-on-code type of talk</li>
    <li>If that's what you're looking for, you should check out GATSBY & DRUPAL SITTING IN A TREE, 3:30 - 4:15pm in Gaige Classroom 202</li>
    <li>This will be a (hopefully) objective view of Gatsby from the perspective of a longtime Drupal dev</li>
    <li>Show of hands, who has used Gatsby before?</li>
    <li>Who has used it on a client project?</li>
    <li>I want to show you an example of Gatsby sourcing data from Drupal.</li>
    <li>Please stop me at any time with questions</li>
  </ul>
</Notes>

---

<AdaptLayout>

  # Zach Weishar
  ## Senior Technical Solutions Manager
  ### @[Adapt](https://adaptagency.com/)

<Notes>
  <ul>
    <li>Full service digital agency with offices in Boston, Copenhagen, Berlin, Barcelona, Kaunas and Vilnius</li>
    <li>We work with diverse array of technologies, including React and Drupal.</li>
    <li>Gatsby is a fascinating intersection between Drupal + React</li>
  </ul>
</Notes>

</AdaptLayout>

---

<AdaptLayout>

# JAMstack
## Javascript, APIs, Markup

<Horizontal style="align-items: flex-start;">
  <img src={html5} style="width: 100%; max-width: 350px;" />
  <img src={js} style="width: 100%; max-width: 350px;" />
  <img src={css3} style="width: 100%; max-width: 350px;" />
</Horizontal>

<Notes>
  <ul>
    <li>JAMstacks are analogous to static sites. The key concept is that they do not nessicarily rely on a server to render HTML documents. Instead, HTML documents are generated, or created ahead of time.</li>
    <li>Gatsby handles this as part of a build process, during which it generates all the pages on your site.</li>
  </ul>
</Notes>

</AdaptLayout>

---

<AdaptLayout>

  # Why JAMstack?

  <ul>
    <li>Fast page loads</li>
    <Appear>
      <li>Reduced security footprint</li>
      <li>Lower hosting costs</li>
      <li>Presentation is seperated from data</li>
    </Appear>
  </ul>

  <Notes>
    <ul>
      <li>HTML documents are generated ahead of time, which means that your users don't need to wait for a server to generate pages on demand</li>
      <li>In addition, the fact that JAMstack's are a collection of static HTML documents means that you can easily distribute them to your Content Delivery Network (CDN) of choice. This means that users get served from a data center that is geographically close to them, further improving the speed of the site.</li>
      <li>Outside of the build process, JAMstack's do not need a direct connection to a server in order to operate. This means no more monitoring for Drupal secuirty updates, no more worrying about patching your servers.</li>
      <li>Professional hosting for a Drupal site is complicated and expensive. With a JAMstack, you don't have to pay these prices. Instead, you can host inexpensively with a static hosting provider like Amazon's S3, Netlify or Zeit.</li>
      <li>This may or may not be a positive depending on the project requirements, but it certaintly offers you a lot of flexiblity. This allows you to mix and match data sources or swap out your back-end down the line with minimal refactoring to your codebase.</li>
  </ul>
  </Notes>

</AdaptLayout>

---

<AdaptLayout>

  # Why Gatsby?

  <ul>
    <li>Even faster page loads</li>
    <Appear>
      <li>Next level image handling</li>
      <li>Data agnostic</li>
      <li>Progressive Web App (PWA) support out of the box</li>
      <li>Rich ecosystem of plugins</li>
    </Appear>
  </ul>

<Notes>
  <ul>
    <li>Performance best practices are baked into Gatsby, which means you get even better perofrmance than with a traditional static site generator. You get things like inlining of critical CSS, prefetching of linked pages, and page caching out of the box.</li>
    <li>Gatsby provides native support for responsive images and for progressive image loading (aka the blur technique from Medium)</li>
    <li>It's simple to add PWA support to your site out of the box, which means that your users can use the site offline. Complex PWA use cases will still require custom code, but Gatsby offers a great baseline here to get you started.</li>
    <li>Much like the Drupal community, the Gatsby community is excellent. There are plugins for just about every data source and use case that you can possibly think of. Honestly, I was shocked to see how far along the ecosysem has come in a relatively short amount of time.</li>
  </ul>
</Notes>

</AdaptLayout>

---

<AdaptLayout>

  # Why Drupal?

  <Appear>
    <iframe src="https://giphy.com/embed/kr5PszPQawIRq" width="328" height="480" frameBorder="0" class="giphy-embed" allowFullScreen />
  </Appear>


  <Notes>
    You're at a Drupal conference, you don't need me to evangelize Drupal for you.
  </Notes>

</AdaptLayout>

---

<AdaptLayout>

  # Drupal + Gatsby

  <ul>
    <li>Drupal is excellent at modeling content and creating structured data</li>
    <Appear>
      <li>Gatsby is an excellent platform for building user intfaces (UI's)</li>
      <li>Gatsby's developer experiance is first class, especially for teams that have already embraced React</li>
      <li>Much of the integration between Gatsby + Drupal is solved by pre-existing plugins</li>
    </Appear>
  </ul>

  <Notes>
    <ul>
      <li>This combination plays to the strengths of both Drupal + Gatsby</li>
      <li>This on top of the benefits that come with the JAMstack itself</li>
    </ul>
  </Notes>

</AdaptLayout>

---

<AdaptLayout>

  # What you loose

</AdaptLayout>

---

<AdaptLayout>

  # Views

  <ul>
    <li>Querying data is done via JSON API Module</li>
    <li>No built in view filters, pagination, etc.</li>
    <li>Only query one entity type at a time</li>
  </ul>

</AdaptLayout>

<Notes>
  <ul>
    <li>Until recently, cross bundle collections were not supported by JSON API. The jsonapi_cross_bundles module aims to solve that</li>
  </ul>
</Notes>

---

<AdaptLayout>

  # Web Forms + Comments

  <ul>
    <li>There is no server to handle form submissions</li>
  </ul>

  <Notes>
    <ul>
      <li>You set up an API route for form submissions on your Drupal site, but if you put Drupal back into the critical path of your application, you negate many of the benefits of this approach</li>
    </ul>
  </Notes>

</AdaptLayout>

---

<AdaptLayout>

  # Automatic redirect creation

  <ul>
    <li>The redirect module is a no brainer on a standard Drupal site, but it won't help you in a decoupled site</li>
  </ul>

</AdaptLayout>

---

<AdaptLayout>

  # Built in Authentication

  <ul>
    <li>There is none.</li>
  </ul>

</AdaptLayout>

---

<AdaptLayout>

  # Content Preview

  <ul>
    <li>Gatsby needs to build in order to see changes on the live site</li>
    <li>If you don't want to preview in production, you also need to add a staging environment for preview</li>
  </ul>

</AdaptLayout>

<Notes>
  <ul>
    <li>Waiting for the site to re-build to preview will become an unnaceptable solution. As the site grows, build times increase</li>
    <li>Almost no one will be ok with previewing in production</li>
  </ul>
</Notes>

---

<AdaptLayout>

  # Client-side solutions form soulutions

  <ul>
    <li>Search
      <ul>
        <li>Pure client-side search, such as JS Search</li>
        <li>API based search such as Aloglia (SaaS), Solr, or Elastic Search</li>
      </ul>
    </li>
    <li>Comments
      <ul>
        <li>Disqus, or a similar client-side solution</li>
      </ul>
    </li>
    <li>Webforms
      <ul>
        <li>TypeForm, Wufoo or another client-side SaaS offering</li>
      </ul>
    </li>
  </ul>

  <Notes>
    <ul>
      <li>Client-side search might be acceptable for very small indexes, but the index gets downloaded on page load, so as it grows your site will slow down</li>
      <li>API based search is much more robust, but of course adds compleixty (or cost if SaaS) to your stack</li>
    </ul>
  </Notes>

</AdaptLayout>

---

<AdaptLayout>

  # Preview

  <ul>
    <li>The Gatsby team has rolled out their first SaaS product to solve this, Gatsby Preview</li>
  </ul>
</AdaptLayout>

<Notes>
  <ul>
    <li>Gatsby preview works really well from what I saw, and there is a companion Drupal module developed by Third & Grove</li>
  </ul>
</Notes>

---

<AdaptLayout>

  # Redirects

  <ul>
    <li>Create redirects in Drupal as usual. At build time, register redirects with your host</li>
    <li>S3: API for CUD updates on redirects</li>
    <li>Netlify: Configure redirects in _redirects file or netlify.toml</li>
  </ul>

</AdaptLayout>

<Notes>
  <ul>
    <li>I haven't built an integration like this before, so it's theoretical at this point. But it should be possible</li>
  </ul>
</Notes>

---

<AdaptLayout>

  # Cutting the cord

  <ul>
    <li>Have you ditched cable for streaming services? This is a similar decision</li>
    <li>Choose exactly what you want and cut what you don't</li>
    <li>But if you want a full cable replacement, the cost of each peice in aggregate might be more than cable</li>
  </ul>

</AdaptLayout>

<Notes>
  I want to make this anaology real quick before I move on. I think the decision between decoupled Gatsbys vs standard Drupal is really similar to the cord cutting debate we have going on right now. You can ditch your expensive cable provider and go with streaming services like Netflix or Hulu, in which case you'll save money on your cable bill. But if you want live TV, movies, access to premium television, you're likely going to pay more than just getting cable. Decoupled Gatsby vs standard Drupal is much the same. If you're trying to get feature parity between Drupal + Gatsby, you might be incurring more cost than going with standard Drupal. By cost, I mean $ for SaaS apps as well as complexity of your application.
</Notes>

---

<AdaptLayout>

  # Gatsby + D8 might make sense when...

  <ul>
    <li>Client doesn't have a large budget for hosting</li>
    <Appear>
      <li>Client doesn't have a dev team to perform security updates</li>
      <li>Performance is a top priority</li>
      <li>You need to pull content from multiple sources</li>
      <li>You have a team of Front-end devs that like working in React</li>
      <li>You're building an interactive app with some static content mixed in</li>
    </Appear>
  </ul>

</AdaptLayout>

---

<AdaptLayout>

  # Gatsby + D8 might not make sense when...

  <ul>
    <li>Site has an extremely high node count</li>
    <Appear>
      <li>Site content is updated frequently</li>
      <li>Site serves personalized pages for authenticated users</li>
    </Appear>
  </ul>

</AdaptLayout>

  <Notes>
    <ul>
      <li>You have to wait for a build to change content, and builds take minutes to finish. If content is updated more quickly than your build process, things will get ugly</li>
      <li>You could mitigate the issue of frequent content updates by scheduling builds. For instance, everything that's published gets deployed automatically at Noon and 5pm</li>
      <li>The more pages you're building, the longer the build process will take</li>
      <li>The client is not waiting for page generation, and your site can be served entierly from a CDN</li>
      <li>Reduce context switching and increasing the ability to reuse components accross projects</li>
      <li>Gatsby is a platform for building React applications</li>
    </ul>
  </Notes>

---

<AdaptLayout>

  # It's a balancing act

  ## You have to decide if the benefits outweigh the challanges for your project

</AdaptLayout>

---

<AdaptLayout>

  # Looking to the future

  <ul>
    <li>Gatsby / Drupal integration will continue to improve + develop along with Drupal's API first initiative</li>
    <Appear>
      <li>Gatsby itself is a venture backed company, which means it's likely to continue innovating</li>
      <li>Gatsby is extremely popular right now, but that may fade over time. The concept of the JAMstack is more durable and more important</li>
    </Appear>
  </ul>

</AdaptLayout>

<Notes>
  <ul>
    <li>Gatsby's first product is Preview, but I assume they will continue to roll out more over time</li>
    <li>I don't know what the future holds for Gatsby, but I can say with a fair bit of confidence that JAMstack will continue to grow in popularity and utility long into the future</li>
  </ul>
</Notes>

---

<AdaptLayout>

# Resources

<ul>
  <li>Rain drupal distribution: https://www.drupal.org/project/rain</li>
  <li>Rain Gatsby companion: https://bitbucket.org/mediacurrent/mis_gatsby_rain/src/develop/</li>
  <li>Build hooks module: https://www.drupal.org/project/build_hooks</li>
  <li>Gatsby live preview: https://www.drupal.org/project/gatsby</li>
  <li>JSON:API Cross Bundles: https://www.drupal.org/project/jsonapi_cross_bundles/</li>
  <li>Infustructure examples: https://www.mediacurrent.com/blog/drupal-behind-firewall-gatsby</li>
</ul>

</AdaptLayout>

---

<AdaptLayout>

# Questions?

</AdaptLayout>
